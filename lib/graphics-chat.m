/*

 HOT DOG Linux

 Copyright (c) 2020 Arthur Choung. All rights reserved.

 Email: arthur -at- hotdoglinux.com

 This file is part of HOT DOG Linux.

 HOT DOG Linux is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program.  If not, see <https://www.gnu.org/licenses/>.

 */

#import "HOTDOG.h"

static char *topLeftPixels =
" b                \n"
"  b               \n"
"  bb              \n"
"   bb             \n"
"   bbb            \n"
"    bbb           \n"
"    bbbb          \n"
"     b.bb         \n"
"     bb.bb        \n"
"      b..bb       \n"
"      bb..bb      \n"
"       b...bb     \n"
"       bb...bb    \n"
"        b....bb   \n"
"        bb....bb  \n"
"         b.....bb \n"
"         b......bb\n"
"     bbbbb.......b\n"
"   bbb............\n"
"  bb..............\n"
" bb...............\n"
" b................\n"
"bb................\n"
;

static char *topLeftPixelsFlipV =
"bb................\n"
" b................\n"
" bb...............\n"
"  bb..............\n"
"   bbb............\n"
"     bbbbb.......b\n"
"         b......bb\n"
"         b.....bb \n"
"        bb....bb  \n"
"        b....bb   \n"
"       bb...bb    \n"
"       b...bb     \n"
"      bb..bb      \n"
"      b..bb       \n"
"     bb.bb        \n"
"     b.bb         \n"
"    bbbb          \n"
"    bbb           \n"
"   bbb            \n"
"   bb             \n"
"  bb              \n"
"  b               \n"
" b                \n"
;

static char *topLeftPixelsFlipH =
"                b \n"
"               b  \n"
"              bb  \n"
"             bb   \n"
"            bbb   \n"
"           bbb    \n"
"          bbbb    \n"
"         bb.b     \n"
"        bb.bb     \n"
"       bb..b      \n"
"      bb..bb      \n"
"     bb...b       \n"
"    bb...bb       \n"
"   bb....b        \n"
"  bb....bb        \n"
" bb.....b         \n"
"bb......b         \n"
"b.......bbbbb     \n"
"............bbb   \n"
"..............bb  \n"
"...............bb \n"
"................b \n"
"................bb\n"
;

static char *topLeftPixelsFlipHV =
"................bb\n"
"................b \n"
"...............bb \n"
"..............bb  \n"
"............bbb   \n"
"b.......bbbbb     \n"
"bb......b         \n"
" bb.....b         \n"
"  bb....bb        \n"
"   bb....b        \n"
"    bb...bb       \n"
"     bb...b       \n"
"      bb..bb      \n"
"       bb..b      \n"
"        bb.bb     \n"
"         bb.b     \n"
"          bbbb    \n"
"           bbb    \n"
"            bbb   \n"
"             bb   \n"
"              bb  \n"
"               b  \n"
"                b \n"
;

static char *topMiddlePixels =
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
"b\n"
".\n"
".\n"
".\n"
".\n"
".\n"
;

static char *topMiddlePixelsFlipV =
".\n"
".\n"
".\n"
".\n"
".\n"
"b\n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
" \n"
;

static char *topRightPixels =
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"b     \n"
"bbb   \n"
"..bb  \n"
"...bb \n"
"...bb \n"
"....bb\n"
;

static char *topRightPixelsFlipV =
"....bb\n"
"...bb \n"
"...bb \n"
"..bb  \n"
"bbb   \n"
"b     \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
;

static char *topRightPixelsFlipH =
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"     b\n"
"   bbb\n"
"  bb..\n"
" bb...\n"
" bb...\n"
"bb....\n"
;

static char *topRightPixelsFlipHV =
"bb....\n"
" bb...\n"
" bb...\n"
"  bb..\n"
"   bbb\n"
"     b\n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
"      \n"
;

static char *middleLeftPixels =
"b\n"
;

static char *middleMiddlePixels =
".\n"
;

static char *middleRightPixels =
"bb\n"
;

static char *bottomLeftPixels =
"b....\n"
"bb...\n"
" b...\n"
" bb..\n"
"  bbb\n"
"   bb\n"
"     \n"
;

static char *bottomLeftPixelsFlipV =
"     \n"
"   bb\n"
"  bbb\n"
" bb..\n"
" b...\n"
"bb...\n"
"b....\n"
;

static char *bottomLeftPixelsFlipH =
"....b\n"
"...bb\n"
"...b \n"
"..bb \n"
"bbb  \n"
"bb   \n"
"     \n"
;

static char *bottomLeftPixelsFlipHV =
"     \n"
"bb   \n"
"bbb  \n"
"..bb \n"
"...b \n"
"...bb\n"
"....b\n"
;

static char *bottomMiddlePixels =
".\n"
".\n"
".\n"
".\n"
".\n"
"b\n"
"b\n"
;

static char *bottomMiddlePixelsFlipV =
"b\n"
"b\n"
".\n"
".\n"
".\n"
".\n"
".\n"
;

static char *bottomRightPixels =
"....bbb\n"
"....bbb\n"
"...bbb \n"
"..bbbb \n"
"bbbbb  \n"
"bbbb   \n"
"bb     \n"
;

static char *bottomRightPixelsFlipV =
"bb     \n"
"bbbb   \n"
"bbbbb  \n"
"..bbbb \n"
"...bbb \n"
"....bbb\n"
"....bbb\n"
;

static char *bottomRightPixelsFlipH =
"bbb....\n"
"bbb....\n"
" bbb...\n"
" bbbb..\n"
"  bbbbb\n"
"   bbbb\n"
"     bb\n"
;

static char *bottomRightPixelsFlipHV =
"     bb\n"
"   bbbb\n"
"  bbbbb\n"
" bbbb..\n"
" bbb...\n"
"bbb....\n"
"bbb....\n"
;

static char *chatBubblePixels =
" b                                                                                                                                                              \n"
"  b                                                                                                                                                             \n"
"  bb                                                                                                                                                            \n"
"   bb                                                                                                                                                           \n"
"   bbb                                                                                                                                                          \n"
"    bbb                                                                                                                                                         \n"
"    bbbb                                                                                                                                                        \n"
"     b.bb                                                                                                                                                       \n"
"     bb.bb                                                                                                                                                      \n"
"      b..bb                                                                                                                                                     \n"
"      bb..bb                                                                                                                                                    \n"
"       b...bb                                                                                                                                                   \n"
"       bb...bb                                                                                                                                                  \n"
"        b....bb                                                                                                                                                 \n"
"        bb....bb                                                                                                                                                \n"
"         b.....bb                                                                                                                                               \n"
"         b......bb                                                                                                                                              \n"
"     bbbbb.......bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb     \n"
"   bbb....................................................................................................................................................bbb   \n"
"  bb........................................................................................................................................................bb  \n"
" bb..........................................................................................................................................................bb \n"
" b...........................................................................................................................................................bb \n"
"bb............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b............bbb..................b......bb...................................................................................................................bb\n"
"b...........b...b.........................b...................................................................................................................bb\n"
"b...........b.....bbb...bb...bb..bb..bb...b....bbb.bb...bb..bbb..b..b.........................................................................................bb\n"
"b............bbb..b..b.b..b.b..b..b....b..b....b..b..b.b..b.b..b.b..b.........................................................................................bb\n"
"b...............b.b..b.bbbb.b.....b..bbb..b....b..b..b.bbbb.b..b.b..b.........................................................................................bb\n"
"b...........b...b.b..b.b....b..b..b.b..b..b....b..b..b.b....b..b.b..b.........................................................................................bb\n"
"b............bbb..bbb...bb...bb...b..bbb..b....b..b..b..bb..b..b..bbb.........................................................................................bb\n"
"b.................b...........................................................................................................................................bb\n"
"b.................b...........................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b...........b...b...............b..b.....b....................................b...............bb.................................b..b.........................bb\n"
"b...........b...b...............b..b..........................................b................b.................................b..b.........................bb\n"
"b...........b...b..bbb..bb.....bbb.bbb..bb..bbb....bbb.bb...bb..bbb..b..b....bbb..bb......bb...b..bb...bb..bbb.....b..b.bbb.....bbb.bbb...bb..................bb\n"
"b...........b...b.b....b..b.....b..b..b..b.b.......b..b..b.b..b.b..b.b..b.....b..b..b....b..b..b.b..b....b.b..b....b..b.b..b.....b..b..b.b..b.................bb\n"
"b...........b...b..bb..bbbb.....b..b..b..b..bb.....b..b..b.bbbb.b..b.b..b.....b..b..b....b.....b.bbbb..bbb.b..b....b..b.b..b.....b..b..b.bbbb.................bb\n"
"b...........b...b....b.b........b..b..b..b....b....b..b..b.b....b..b.b..b.....b..b..b....b..b..b.b....b..b.b..b....b..b.b..b.....b..b..b.b....................bb\n"
"b............bbb..bbb...bb.......b.b..b..b.bbb.....b..b..b..bb..b..b..bbb......b..bb......bb...b..bb...bbb.b..b.....bbb.bbb.......b.b..b..bb..................bb\n"
"b.......................................................................................................................b.....................................bb\n"
"b.......................................................................................................................b.....................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b............b.........................b..........................b.........b......................b.............................b............................bb\n"
"b...........................................................................b......................b.............................b............................bb\n"
"b...........bb..bb...bb..bbb...bbb....bb.bbb......bb.....b.....b.bb.bbb...bbb..bb..b.....b........bbb..bb......bb..bbb.bb..bbb..bbb.b..b......................bb\n"
"b............b.b..b.b..b.b..b.b........b.b..b.......b.....b.b.b...b.b..b.b..b.b..b..b.b.b..........b..b..b....b..b.b..b..b.b..b..b..b..b......................bb\n"
"b............b.b....b..b.b..b..bb......b.b..b.....bbb.....b.b.b...b.b..b.b..b.b..b..b.b.b..........b..b..b....bbbb.b..b..b.b..b..b..b..b......................bb\n"
"b............b.b..b.b..b.b..b....b.....b.b..b....b..b......b.b....b.b..b.b..b.b..b...b.b...........b..b..b....b....b..b..b.b..b..b..b..b......................bb\n"
"b............b..bb...bb..b..b.bbb......b.b..b.....bbb......b.b....b.b..b..bbb..bb....b.b.....b......b..bb......bb..b..b..b.bbb....b..bbb......................bb\n"
"b............................................................................................b.............................b...........b......................bb\n"
"b...........................................................................................b..............................b.........bb.......................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b............b..b............b.....b............b.......b..............b..........b..........b................................................................bb\n"
"b............b..b............b.....b............b.......b..............b..........b..........b................................................................bb\n"
"b...........bbb.bbb...bb......b.b.b...bb...bbb.bbb..bb..bbb...bb...bbb.b..b..bb..bbb........bbb..bb......bb..b.bb..bb...bbb..bb...............................bb\n"
"b............b..b..b.b..b.....b.b.b.....b.b.....b..b..b.b..b....b.b....b.b..b..b..b..........b..b..b....b..b.bb......b.b....b..b..............................bb\n"
"b............b..b..b.bbbb......b.b....bbb..bb...b..bbbb.b..b..bbb..bb..bb...bbbb..b..........b..b..b....bbbb.b.....bbb..bb..bbbb..............................bb\n"
"b............b..b..b.b.........b.b...b..b....b..b..b....b..b.b..b....b.b.b..b.....b..........b..b..b....b....b....b..b....b.b.................................bb\n"
"b.............b.b..b..bb.......b.b....bbb.bbb....b..bb..bbb...bbb.bbb..b..b..bb....b...b......b..bb......bb..b.....bbb.bbb...bb...............................bb\n"
"b......................................................................................b......................................................................bb\n"
"b.....................................................................................b.......................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b..............b..b......b.............................b.....b................b.............b.................................................................bb\n"
"b..............b.........b.............................b.....b................b.............b.................................................................bb\n"
"b............bbb.bb..bbb.b..b..bbb.........bb..bbb...bbb....bbb..bb......bbb.bbb..bb..b.bb.bbb.....bb..b...b..bb..b.bb.....bb..b.bb...........................bb\n"
"b...........b..b..b.b....b.b..b..............b.b..b.b..b.....b..b..b....b.....b.....b.bb....b.....b..b..b.b..b..b.bb......b..b.bb.............................bb\n"
"b...........b..b..b..bb..bb....bb..........bbb.b..b.b..b.....b..b..b.....bb...b...bbb.b.....b.....b..b..b.b..bbbb.b.......b..b.b..............................bb\n"
"b...........b..b..b....b.b.b.....b........b..b.b..b.b..b.....b..b..b.......b..b..b..b.b.....b.....b..b...b...b....b.......b..b.b..............................bb\n"
"b............bbb..b.bbb..b..b.bbb....b.....bbb.b..b..bbb......b..bb.....bbb....b..bbb.b......b.....bb....b....bb..b........bb..b..............................bb\n"
"b....................................b........................................................................................................................bb\n"
"b...................................b.........................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.................b..........................b...............b..b.........................................b...................................................bb\n"
"b.................b..........................................b..b.........................................b...................................................bb\n"
"b............bbb.bbb..bb..bbb.....b..b..bbb.bb.bbb...bbb....bbb.bbb...bb......bb...bb..bbb.bb..bbb..b..b.bbb..bb..b.bb........................................bb\n"
"b...........b.....b..b..b.b..b....b..b.b.....b.b..b.b..b.....b..b..b.b..b....b..b.b..b.b..b..b.b..b.b..b..b..b..b.bb..........................................bb\n"
"b............bb...b..b..b.b..b....b..b..bb...b.b..b.b..b.....b..b..b.bbbb....b....b..b.b..b..b.b..b.b..b..b..bbbb.b...........................................bb\n"
"b..............b..b..b..b.b..b....b..b....b..b.b..b.b..b.....b..b..b.b.......b..b.b..b.b..b..b.b..b.b..b..b..b....b...........................................bb\n"
"b...........bbb....b..bb..bbb......bbb.bbb...b.b..b..bbb......b.b..b..bb......bb...bb..b..b..b.bbb...bbb...b..bb..b.....b.....................................bb\n"
"b.........................b............................b.......................................b..............................................................bb\n"
"b.........................b..........................bb........................................b..............................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b.............................................................................................................................................................bb\n"
"b............................................................................................................................................................bbb\n"
"bb...........................................................................................................................................................bbb\n"
" b..........................................................................................................................................................bbb \n"
" bb........................................................................................................................................................bbbb \n"
"  bbb....................................................................................................................................................bbbbb  \n"
"   bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb   \n"
"     bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb     \n"
;

@implementation Definitions(fjkldsjflkdslkfj)

+ (Int4)drawChatBubbleInBitmap:(id)bitmap rect:(Int4)r text:(id)text
{
    Int4 chatRect = [Definitions drawChatBubbleInBitmap:bitmap rect:r text:text fgcolor:@"#000000" bgcolor:@"#ffffff" flipHorizontal:NO flipVertical:NO];
    return chatRect;
}


+ (Int4)drawChatBubbleInBitmap:(id)bitmap rect:(Int4)r text:(id)text fgcolor:(id)fgcolor bgcolor:(id)bgcolor flipHorizontal:(BOOL)flipHorizontal flipVertical:(BOOL)flipVertical
{
    id palettestr = nsfmt(@"b %@\n. %@\n", fgcolor, bgcolor);
    char *palette = [palettestr UTF8String];

    char *TLPixels = topLeftPixels;
    char *TMPixels = topMiddlePixels;
    char *TRPixels = topRightPixels;
    char *MLPixels = middleLeftPixels;
    char *MMPixels = middleMiddlePixels;
    char *MRPixels = middleRightPixels;
    char *BLPixels = bottomLeftPixels;
    char *BMPixels = bottomMiddlePixels;
    char *BRPixels = bottomRightPixels;
    if (flipHorizontal && flipVertical) {
        TLPixels = bottomRightPixelsFlipHV;
        TMPixels = bottomMiddlePixelsFlipV;
        TRPixels = bottomLeftPixelsFlipHV;
        MLPixels = middleRightPixels;
        MRPixels = middleLeftPixels;
        BLPixels = topRightPixelsFlipHV;
        BMPixels = topMiddlePixelsFlipV;
        BRPixels = topLeftPixelsFlipHV;
    } else if (flipHorizontal) {
        TLPixels = topRightPixelsFlipH;
        TRPixels = topLeftPixelsFlipH;
        MLPixels = middleRightPixels;
        MRPixels = middleLeftPixels;
        BLPixels = bottomRightPixelsFlipH;
        BRPixels = bottomLeftPixelsFlipH;
    } else if (flipVertical) {
        TLPixels = bottomLeftPixelsFlipV;
        TMPixels = bottomMiddlePixelsFlipV;
        TRPixels = bottomRightPixelsFlipV;
        BLPixels = topLeftPixelsFlipV;
        BMPixels = topMiddlePixelsFlipV;
        BRPixels = topRightPixelsFlipV;
    }

    int topMiddleHeight = [Definitions heightForCString:TMPixels];
    int middleMiddleHeight = [Definitions heightForCString:MMPixels];
    int bottomMiddleHeight = [Definitions heightForCString:BMPixels];

    Int4 bubbleRect = r;
    Int4 textRect = bubbleRect;
    textRect.x += 8;
    textRect.y += topMiddleHeight;
    textRect.w -= 16;
    text = [bitmap fitBitmapString:text width:textRect.w];
    int textWidth = [Definitions bitmapWidthForText:text];
    int textHeight = [Definitions bitmapHeightForText:text];
    bubbleRect.w = textWidth + 16;
    bubbleRect.h = textHeight + 23 + 7;
    textRect.h = textHeight;

    if (flipHorizontal) {
        int margin = r.w - bubbleRect.w;
        bubbleRect.x += margin;
        textRect.x += margin;
    }

    int startX = bubbleRect.x;
    int startY = bubbleRect.y;

    [Definitions drawInBitmap:bitmap left:TLPixels middle:TMPixels right:TRPixels x:startX y:startY w:bubbleRect.w palette:palette];
    for (int y=topMiddleHeight; y<bubbleRect.h-bottomMiddleHeight; y+=middleMiddleHeight) {
        [Definitions drawInBitmap:bitmap left:MLPixels middle:MMPixels right:MRPixels x:startX y:startY+y w:bubbleRect.w palette:palette];
    }
    [Definitions drawInBitmap:bitmap left:BLPixels middle:BMPixels right:BRPixels x:startX y:bubbleRect.y+bubbleRect.h-bottomMiddleHeight w:bubbleRect.w palette:palette];

    [bitmap setColor:fgcolor];
    [bitmap drawBitmapText:text x:textRect.x y:textRect.y];

    return bubbleRect;
}


@end

